# Splunk inputs.conf for Linux IDS
# Place in $SPLUNK_HOME/etc/system/local/ or app directory

# Main IDS detection log
[monitor:///var/log/ids/detection.json]
disabled = false
index = security
sourcetype = linux_ids
# Use batch mode for better performance
batch_mode = true
# Check for new data every 10 seconds
interval = 10

# IDS monitoring script - runs every 60 seconds
[script:///opt/ids/ids-monitor.sh]
disabled = false
index = security
sourcetype = linux_ids
interval = 60
# Pass environment variables if needed
passAuth = false

# System authentication logs
[monitor:///var/log/auth.log]
disabled = false
index = security
sourcetype = linux_secure
# Monitor in real-time for authentication events
followTail = 1

# Alternative for RHEL/CentOS
[monitor:///var/log/secure]
disabled = false
index = security
sourcetype = linux_secure
followTail = 1

# Kernel logs for privilege escalation detection
[monitor:///var/log/kern.log]
disabled = false
index = security
sourcetype = linux_kernel
followTail = 1

# System logs
[monitor:///var/log/syslog]
disabled = false
index = os
sourcetype = syslog
followTail = 1

# Apache access logs (if applicable)
[monitor:///var/log/apache2/access.log]
disabled = false
index = web
sourcetype = apache_access
followTail = 1

# Apache error logs
[monitor:///var/log/apache2/error.log]
disabled = false
index = web
sourcetype = apache_error
followTail = 1

# Nginx access logs (if applicable)
[monitor:///var/log/nginx/access.log]
disabled = false
index = web
sourcetype = nginx_access
followTail = 1

# Package management logs
[monitor:///var/log/apt/history.log]
disabled = false
index = os
sourcetype = linux_packages
followTail = 1

[monitor:///var/log/yum.log]
disabled = false
index = os
sourcetype = linux_packages
followTail = 1

# Firewall logs (UFW)
[monitor:///var/log/ufw.log]
disabled = false
index = security
sourcetype = linux_firewall
followTail = 1

# Custom iptables log (if configured)
[monitor:///var/log/iptables.log]
disabled = false
index = security
sourcetype = linux_firewall
followTail = 1

# Audit logs (if auditd is installed)
[monitor:///var/log/audit/audit.log]
disabled = false
index = security
sourcetype = linux_audit
followTail = 1

# File integrity monitoring output
[monitor:///var/lib/ids/*.json]
disabled = false
index = security
sourcetype = linux_ids
batch_mode = true

# Whitelist/Blacklist for monitoring
# Ignore certain files to reduce noise
[monitor:///var/log/ids/detection.json]
blacklist = \.swp$|\.tmp$|~$

# Network monitoring script output
[script:///opt/ids/network-monitor.sh]
disabled = false
index = security
sourcetype = linux_ids_network
interval = 30

# Process monitoring script
[script:///opt/ids/process-monitor.sh]
disabled = false
index = security
sourcetype = linux_ids_process
interval = 120

# Baseline verification
[script:///var/lib/ids/baseline/verify_baseline.sh]
disabled = false
index = security
sourcetype = linux_ids_baseline
# Run daily at 2 AM
interval = 0 2 * * *