#!/bin/sh
# IDS Configuration File
# Format: KEY=VALUE (no spaces around =)

# System Identification
HOSTNAME=$(hostname 2>/dev/null || printf "unknown")

# Paths
IDS_HOME="/var/log/ids"
BASELINE_FILE="/var/log/ids/baseline.dat"
ALERT_LOG="/var/log/ids/alerts.json"
MONITOR_LOG="/var/log/ids/monitor.json"

# Log rotation
MAX_LOG_SIZE=10485760  # 10MB in bytes
MAX_LOG_FILES=5

# Network Monitoring
PORT_SCAN_THRESHOLD=10     # Connections from same IP in 60s
BRUTE_FORCE_THRESHOLD=5    # Failed logins in 5 minutes
OUTBOUND_PORT_WHITELIST="22,80,443,53,123"  # Common allowed ports

# File System Monitoring
CRITICAL_FILES="/etc/passwd /etc/shadow /etc/sudoers /etc/ssh/sshd_config"
CRITICAL_DIRS="/bin /sbin /usr/bin /usr/sbin"
WEB_DIRS="/var/www /usr/share/nginx /usr/share/apache2"

# Authentication
MAX_FAILED_LOGINS=5        # Per 5 minutes
SUDO_ANOMALY_THRESHOLD=10  # Sudo commands per hour

# Process Monitoring
CPU_THRESHOLD=80           # Percentage
MEM_THRESHOLD=90           # Percentage
DISK_THRESHOLD=90          # Percentage
PROC_COUNT_THRESHOLD=500   # Maximum processes

# Cryptominer signatures
MINER_PATTERNS="xmrig|minerd|minergate|ethminer|cgminer|bfgminer"

# Timing
CHECK_INTERVAL=60          # Seconds between checks
BASELINE_AGE_WARN=86400    # Warn if baseline older than 24h

# Severity Levels
SEV_CRITICAL="critical"
SEV_HIGH="high"
SEV_MEDIUM="medium"
SEV_LOW="low"
SEV_INFO="info"

# Alert Methods
ALERT_TO_SYSLOG=1          # 0=disabled, 1=enabled
ALERT_TO_FILE=1            # Write to alert log
ALERT_TO_STDOUT=0          # Print to terminal